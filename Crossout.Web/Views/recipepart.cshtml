@using Crossout.Web
@using Crossout.Model.Items;
@using Crossout.Model.Recipes
@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<Crossout.Model.Recipes.RecipeItem>

@{
    Item item = Model.Item;
}

<tr class="@(Model.Depth > 0 ? "collapse" : "") recipe-@(Model.ParentRecipe)">
    <td>
        <div class="clearfix content-heading">
            <div class="clearfix vertical-center pull-left">
                @for (int i = 0; i < Model.Depth; i++)
                {
                    <div style="margin-left: 40px;">&nbsp;</div>
                }
                @if (Model.Ingredients.Count > 0)
                {
                    if (Model.Depth == 0)
                    {
                        <button class="btn btn-xs btn-main tree-icon glyphicon glyphicon-plus" id="item-@item.Id"></button>
                    }
                    else
                    {
                        <button class="btn btn-xs btn-sub tree-icon glyphicon glyphicon-plus" id="item-@item.Id"></button>
                    }
                }
                <div>
                    @if (Model.Depth == 0)
                    {
                        <a href="~/item/@item.Id"><img style="margin-right: 8px;" src="~/img/items/@item.Image"/></a>
                    }
                    else
                    {
                        <a href="~/item/@item.Id"><img style="margin-right: 8px; height: 32px;" src="~/img/items/@item.Image" /></a>
                    }
                </div>
            </div>
            @if (Model.Depth == 0)
            {
                <a href="~/item/@Model.Item.Id"><h4 style="font-weight: bold;">@Model.Item.Name</h4></a>
                <div style="font-weight: bold;">@Model.Item.TypeName</div>
            }
            else
            {
                <a href="~/item/@item.Id" style="font-weight: bold;">@item.Name</a>
                <div>@item.TypeName</div>
            }
        </div>
    </td>
    <td>
        <span class="label label-@item.RarityName">@item.RarityName</span>
    </td>
    <td>
        <div class="label-md">
            @item.FormatSellPrice <img height="14" src="~/img/Coin.png"/>
        </div>
    </td>
    <td>
        <div class="label-md">@item.SellOffers</div>
    </td>
    <td>
        <div class="label-md">
            @item.FormatBuyPrice <img height="14" src="~/img/Coin.png"/>
        </div>
    </td>
    <td>
        <div class="label-md">@item.BuyOrders</div>
    </td>
    <td>
        <div class="label-md">
            @item.FormatMargin <img height="14" src="~/img/Coin.png"/>
        </div>
    </td>
</tr>


<script>
    $(document).ready(function () {
        
        $('#item-@Model.Item.Id').click(function () {
            $('.recipe-' + '@Model.Item.RecipeId').collapse('toggle');
            if ($(this).hasClass('glyphicon-plus')) {
                $(this).removeClass('glyphicon-plus').addClass('glyphicon-minus');
            } else {
                $(this).removeClass('glyphicon-minus').addClass('glyphicon-plus');
            }
        });
    });
</script>