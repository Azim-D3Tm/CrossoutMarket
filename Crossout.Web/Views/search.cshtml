@{
    Layout = "layout.cshtml";
}

@using Crossout.Model.Items
@using Crossout.Web
@using Crossout.Web.Models
@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<Crossout.Web.Models.General.SearchModel>


@Html.Partial("header", Model)

@Html.Partial("status", Model.Status)

<div class="container-space">
    <div class="panel panel-default">
        <div class="panel-body">
            @Html.Partial("filter", Model)
        </div>
    </div>
    <div class="panel panel-default">
        <table id="ItemTable" class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>
                        Name
                    </th>
                    <th>
                        Rarity
                    </th>
                    <th class="text-right">
                        Popularity
                    </th>
                    <th class="text-right">
                        Sell Price
                    </th>
                    <th class="text-right">
                        Sell Offers
                    </th>
                    <th class="text-right">
                        Buy Price
                    </th>
                    <th class="text-right">
                        Buy Orders
                    </th>
                    <th class="text-right">
                        Margin
                    </th>
                    <th class="text-right">
                        Last Update
                    </th>
                </tr>
            </thead>

            <tbody>
                @foreach (Item item in Model.SearchResult)
                {
                    @Html.Partial("itempart", item)
                }
            </tbody>
        </table>
    </div>

    <div class="panel panel-default">
        <div class="panel-body">
            @Html.Partial("filter", Model)
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {

        var domOption =
            "<'content-space'<'row'<'col-sm-6'p><'col-sm-4'f><'col-sm-2'l>>>" +
            "tr" +
            "<'content-space'<'row'<'col-sm-6'p><'col-sm-2'B><'col-sm-2'i><'col-sm-2'l>>>";

        $.fn.DataTable.ext.pager.numbers_length = 10;

        $('#ItemTable').DataTable({
            paging: true,
            searching: true,
            search: {
                smart: false,
                regex: true
            },
            buttons: {
                dom: {
                    container: {
                        tag: 'ul',
                        className: 'pagination dataTables_button'
                    },
                    buttonContainer: {
                        tag: 'li',
                        className: 'paginate_button'
                    },
                    button: {
                        tag: 'a',
                        className: ''
                    }
                },
                buttons: [{
                    extend: 'excel',
                    text: 'Export as Excel',
                    filename: 'CrossoutDBExcelExport',
                    exportOptions: {
                        modifier: {
                            page: 'current'
                        }
                    }
                }, {
                    extend: 'csv',
                    text: 'Export as CSV',
                    filename: 'CrossoutDBCSVExport',
                    exportOptions: {
                        modifier: {
                            page: 'current'
                        }
                    }
                }]
            },
            order: [[2, "asc"]],
            lengthMenu: [[10,20, 50, -1], [10,20, 50, "All"]],
            pagingType: "full_numbers",
            dom: domOption
        });
    });
</script>
